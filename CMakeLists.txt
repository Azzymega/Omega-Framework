cmake_minimum_required(VERSION 3.25)
project(runtime)
set(CMAKE_CXX_FLAGS -static-libgcc)
set(CMAKE_CXX_FLAGS -static-libstdc++)
set(CMAKE_CXX_STANDARD 17)
set ( CMAKE_WINDOWS_EXPORT_ALL_SYMBOLS ON )
add_executable(runtime main.cpp cpu.cpp cpu.h microcode.cpp microcode.h vmldr/ldr.h)
add_executable(asmcmplr asmcmplr/cmplr.cpp asmcmplr/cmplr.h vmldr/ldr.h vmldr/ldr.cpp)
add_library( ldr SHARED vmldr/ldr.cpp vmldr/ldr.h)
add_library( wrt SHARED vmwrt/wrtr.cpp vmwrt/wrtr.h)
add_library( cmp SHARED asmcmplr/image.cpp asmcmplr/image.h)
add_library( tkn SHARED asmcmplr/token.cpp asmcmplr/token.h asmcmplr/tokenFactory.cpp asmcmplr/tokenFactory.h asmcmplr/tokens/mov.cpp asmcmplr/tokens/mov.h asmcmplr/tokens/cmv.cpp asmcmplr/tokens/cmv.h asmcmplr/tokens/hlt.cpp asmcmplr/tokens/hlt.h asmcmplr/tokens/jmp.cpp asmcmplr/tokens/jmp.h asmcmplr/tokens/add.cpp asmcmplr/tokens/add.h asmcmplr/tokens/sub.cpp asmcmplr/tokens/sub.h)
include(GenerateExportHeader)
generate_export_header(ldr)
target_link_libraries(runtime PRIVATE ldr)
target_link_libraries(runtime PRIVATE wrt)
target_link_libraries(asmcmplr PRIVATE ldr)
target_link_libraries(asmcmplr PRIVATE cmp)
target_link_libraries(asmcmplr PRIVATE wrt)
target_link_libraries(asmcmplr PRIVATE tkn)